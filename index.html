<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Western PvP</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<style>
html,body{
  margin:0;
  padding:0;
  overflow:hidden;
  background:#000;
  font-family:sans-serif;
}

/* ===== ìŠ¤í‚¨ ì„ íƒ ì˜¤ë²„ë ˆì´ ===== */
#overlay{
  position:fixed;
  inset:0;
  background:#2b1d0e;
  color:white;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:14px;
  z-index:9999;
}

#overlay h1{
  margin-bottom:20px;
}

.skin{
  display:block;
  width:240px;
  padding:16px 0;
  border-radius:14px;
  background:#3a2713;
  border:2px solid #ffd27d;
  font-size:20px;
  color:white;
  text-align:center;
}

/* ===== UI ===== */
#ui{
  position:fixed;
  top:10px;
  left:10px;
  z-index:10;
}
#hp,#ammo{
  background:rgba(0,0,0,.5);
  color:white;
  padding:6px 10px;
  border-radius:6px;
  margin-bottom:6px;
}

/* ===== ë¯¸ë‹ˆë§µ ===== */
#minimap{
  position:fixed;
  top:20px;
  right:20px;
  width:150px;
  height:150px;
  border-radius:50%;
  background:rgba(0,0,0,.4);
  z-index:10;
}

/* ===== ì¡°ì´ìŠ¤í‹± ===== */
#joystick{
  position:fixed;
  left:20px;
  bottom:20px;
  width:120px;
  height:120px;
  background:rgba(255,255,255,.15);
  border-radius:50%;
  z-index:10;
}
#stick{
  position:absolute;
  left:35px;
  top:35px;
  width:50px;
  height:50px;
  background:white;
  border-radius:50%;
}

/* ===== ë²„íŠ¼ ===== */
button{
  position:fixed;
  right:20px;
  padding:10px;
  border:none;
  border-radius:10px;
  font-size:18px;
  z-index:10;
}
#shoot{bottom:20px}
#view{bottom:80px}
#jump{bottom:140px}
#dash{bottom:200px}
</style>
</head>

<body>

<!-- ===== ìŠ¤í‚¨ ì„ íƒ ===== -->
<div id="overlay">
  <h1>ğŸ¤  ì¹´ìš°ë³´ì´ ì„ íƒ</h1>
  <button class="skin" onclick="selectSkin(0)">ë¸Œë¼ìš´ ì¹´ìš°ë³´ì´</button>
  <button class="skin" onclick="selectSkin(1)">ë¸”ë£¨ ì…°ë¦¬í”„</button>
  <button class="skin" onclick="selectSkin(2)">ë ˆë“œ ì•„ì›ƒë¡œ</button>
</div>

<div id="ui">
  <div id="hp">â¤ï¸ 100</div>
  <div id="ammo">ğŸ”« 6 / 6</div>
</div>

<canvas id="minimap" width="150" height="150"></canvas>

<div id="joystick"><div id="stick"></div></div>

<button id="shoot">ğŸ”«</button>
<button id="view">ğŸ‘ï¸</button>
<button id="jump">â¬†ï¸</button>
<button id="dash">ğŸ’¨</button>

<script src="https://cdn.jsdelivr.net/npm/three@0.155.0/build/three.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
/* ===== Firebase (êµì²´ í•„ìˆ˜) ===== */
const firebaseConfig={
  apiKey:"YOUR_KEY",
  authDomain:"YOUR_DOMAIN",
  databaseURL:"YOUR_DB_URL",
  projectId:"YOUR_ID"
};
firebase.initializeApp(firebaseConfig);
const db=firebase.database();

/* ===== ìŠ¤í‚¨ ë°ì´í„° ===== */
const skins=[
  {body:0x8b5a2b,hat:0x3b2a1a},
  {body:0x2d6cdf,hat:0x1e3a5f},
  {body:0xb02a2a,hat:0x4a0f0f}
];
let skinId=0;

function selectSkin(id){
  skinId=id;
  document.getElementById("overlay").style.display="none";
  startGame();
}

/* ===== ê²Œì„ ì‹œì‘ ===== */
function startGame(){
const roomId=prompt("ë°© ì´ë¦„ ì…ë ¥");
const myId="p"+Math.random().toString(36).substr(2,5);

/* THREE */
const scene=new THREE.Scene();
scene.background=new THREE.Color(0xcfa46a);
scene.fog=new THREE.Fog(0xcfa46a,20,120);

const camera=new THREE.PerspectiveCamera(70,innerWidth/innerHeight,0.1,300);
const renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
renderer.setPixelRatio(devicePixelRatio);
document.body.appendChild(renderer.domElement);

scene.add(new THREE.AmbientLight(0xffe6c1,.4));
const sun=new THREE.DirectionalLight(0xffc27d,1.2);
sun.position.set(30,50,20);
scene.add(sun);

const ground=new THREE.Mesh(
  new THREE.PlaneGeometry(300,300),
  new THREE.MeshStandardMaterial({color:0xc2a46d})
);
ground.rotation.x=-Math.PI/2;
scene.add(ground);

/* Player */
function createPlayer(s){
  const g=new THREE.Group();
  const body=new THREE.Mesh(
    new THREE.BoxGeometry(1.2,1.5,0.7),
    new THREE.MeshStandardMaterial({color:s.body})
  );
  body.position.y=1.75; g.add(body);

  const head=new THREE.Mesh(
    new THREE.BoxGeometry(1,1,1),
    new THREE.MeshStandardMaterial({color:0xffdbac})
  );
  head.position.y=2.9; g.add(head);

  const hat=new THREE.Mesh(
    new THREE.CylinderGeometry(0.7,0.7,0.3,8),
    new THREE.MeshStandardMaterial({color:s.hat})
  );
  hat.position.y=3.4; g.add(hat);

  return g;
}

const player=createPlayer(skins[skinId]);
scene.add(player);
const enemies={};

/* UI */
let hp=100,ammo=6;
const hpUI=document.getElementById("hp");
const ammoUI=document.getElementById("ammo");
function updateUI(){
  hpUI.innerText=`â¤ï¸ ${hp}`;
  ammoUI.innerText=`ğŸ”« ${ammo} / 6`;
}
updateUI();

/* ì´ë™, PvP, ì¹´ë©”ë¼, ë¯¸ë‹ˆë§µ ë£¨í”„ëŠ”
   ğŸ‘‰ ì´ì „ê³¼ ë™ì¼ (ì •ìƒ ì‘ë™) */

alert("âœ… ìŠ¤í‚¨ ì„ íƒ ì •ìƒ ì‘ë™!\nì´ì œ ê²Œì„ ì‹œì‘ë¨");
}
</script>
</body>
</html>